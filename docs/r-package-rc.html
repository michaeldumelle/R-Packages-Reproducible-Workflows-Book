<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Making an R Package a Research Compendium | Using R Packages for Reproducible Workflows</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.23 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Making an R Package a Research Compendium | Using R Packages for Reproducible Workflows" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="michaeldumelle/R-Packages-Reproducible-Workflows-Book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Making an R Package a Research Compendium | Using R Packages for Reproducible Workflows" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Michael Dumelle" />


<meta name="date" content="2021-09-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="r-package.html"/>
<link rel="next" href="extensions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using R Packages for Reproducible Workflows</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#schedule"><i class="fa fa-check"></i>Schedule</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-me"><i class="fa fa-check"></i>About Me</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#getting-started"><i class="fa fa-check"></i>Getting Started</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="r-package.html"><a href="r-package.html"><i class="fa fa-check"></i><b>1</b> Building an R Package</a><ul>
<li class="chapter" data-level="1.1" data-path="r-package.html"><a href="r-package.html#what-is-an-r-package"><i class="fa fa-check"></i><b>1.1</b> What is an R Package?</a><ul>
<li class="chapter" data-level="1.1.1" data-path="r-package.html"><a href="r-package.html#ex-set1"><i class="fa fa-check"></i><b>1.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="r-package.html"><a href="r-package.html#creating-an-r-package"><i class="fa fa-check"></i><b>1.2</b> Creating an R Package</a><ul>
<li class="chapter" data-level="1.2.1" data-path="r-package.html"><a href="r-package.html#the-motivating-dataset"><i class="fa fa-check"></i><b>1.2.1</b> The Motivating Dataset</a></li>
<li class="chapter" data-level="1.2.2" data-path="r-package.html"><a href="r-package.html#first-step"><i class="fa fa-check"></i><b>1.2.2</b> The First Step</a></li>
<li class="chapter" data-level="1.2.3" data-path="r-package.html"><a href="r-package.html#some-prelminaries"><i class="fa fa-check"></i><b>1.2.3</b> Some prelminaries</a></li>
<li class="chapter" data-level="1.2.4" data-path="r-package.html"><a href="r-package.html#first-function"><i class="fa fa-check"></i><b>1.2.4</b> The First Function</a></li>
<li class="chapter" data-level="1.2.5" data-path="r-package.html"><a href="r-package.html#load-all"><i class="fa fa-check"></i><b>1.2.5</b> <code>devtools::load_all()</code></a><ul>
<li class="chapter" data-level="1.2.5.1" data-path="r-package.html"><a href="r-package.html#ex-set2"><i class="fa fa-check"></i><b>1.2.5.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.2.6" data-path="r-package.html"><a href="r-package.html#creating-data"><i class="fa fa-check"></i><b>1.2.6</b> Creating Package Data</a></li>
<li class="chapter" data-level="1.2.7" data-path="r-package.html"><a href="r-package.html#roxygen"><i class="fa fa-check"></i><b>1.2.7</b> roxygen Comments</a></li>
<li class="chapter" data-level="1.2.8" data-path="r-package.html"><a href="r-package.html#second-function"><i class="fa fa-check"></i><b>1.2.8</b> The Second Function</a><ul>
<li class="chapter" data-level="1.2.8.1" data-path="r-package.html"><a href="r-package.html#ex-set3"><i class="fa fa-check"></i><b>1.2.8.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.2.9" data-path="r-package.html"><a href="r-package.html#description"><i class="fa fa-check"></i><b>1.2.9</b> <code>DESCRIPTION</code></a></li>
<li class="chapter" data-level="1.2.10" data-path="r-package.html"><a href="r-package.html#namespace"><i class="fa fa-check"></i><b>1.2.10</b> <code>NAMESPACE</code></a></li>
<li class="chapter" data-level="1.2.11" data-path="r-package.html"><a href="r-package.html#testthat"><i class="fa fa-check"></i><b>1.2.11</b> testthat</a><ul>
<li class="chapter" data-level="1.2.11.1" data-path="r-package.html"><a href="r-package.html#ex-set4"><i class="fa fa-check"></i><b>1.2.11.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.2.12" data-path="r-package.html"><a href="r-package.html#license"><i class="fa fa-check"></i><b>1.2.12</b> License</a></li>
<li class="chapter" data-level="1.2.13" data-path="r-package.html"><a href="r-package.html#vignettes"><i class="fa fa-check"></i><b>1.2.13</b> Vignettes</a></li>
<li class="chapter" data-level="1.2.14" data-path="r-package.html"><a href="r-package.html#check"><i class="fa fa-check"></i><b>1.2.14</b> <code>devtools::check()</code></a></li>
<li class="chapter" data-level="1.2.15" data-path="r-package.html"><a href="r-package.html#install"><i class="fa fa-check"></i><b>1.2.15</b> <code>devtools::install()</code></a><ul>
<li class="chapter" data-level="1.2.15.1" data-path="r-package.html"><a href="r-package.html#ex-set5"><i class="fa fa-check"></i><b>1.2.15.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="1.2.16" data-path="r-package.html"><a href="r-package.html#congratulations"><i class="fa fa-check"></i><b>1.2.16</b> Congratulations</a></li>
<li class="chapter" data-level="1.2.17" data-path="r-package.html"><a href="r-package.html#a-recap"><i class="fa fa-check"></i><b>1.2.17</b> A Recap</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="r-package.html"><a href="r-package.html#debugging"><i class="fa fa-check"></i><b>1.3</b> Debugging</a><ul>
<li class="chapter" data-level="1.3.1" data-path="r-package.html"><a href="r-package.html#error-onematch"><i class="fa fa-check"></i><b>1.3.1</b> A Mysterious Error Message</a></li>
<li class="chapter" data-level="1.3.2" data-path="r-package.html"><a href="r-package.html#traceback"><i class="fa fa-check"></i><b>1.3.2</b> <code>traceback()</code></a></li>
<li class="chapter" data-level="1.3.3" data-path="r-package.html"><a href="r-package.html#browser"><i class="fa fa-check"></i><b>1.3.3</b> <code>browser()</code></a></li>
<li class="chapter" data-level="1.3.4" data-path="r-package.html"><a href="r-package.html#error-zeromatch"><i class="fa fa-check"></i><b>1.3.4</b> Another Error – No Mysterious Message</a><ul>
<li class="chapter" data-level="1.3.4.1" data-path="r-package.html"><a href="r-package.html#ex-set6"><i class="fa fa-check"></i><b>1.3.4.1</b> Exercises</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="r-package.html"><a href="r-package.html#add-resources"><i class="fa fa-check"></i><b>1.4</b> Additional Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-package-rc.html"><a href="r-package-rc.html"><i class="fa fa-check"></i><b>2</b> Making an R Package a Research Compendium</a><ul>
<li class="chapter" data-level="2.1" data-path="r-package-rc.html"><a href="r-package-rc.html#what-is-a-rc"><i class="fa fa-check"></i><b>2.1</b> What is a Research Compendium?</a><ul>
<li class="chapter" data-level="2.1.1" data-path="r-package-rc.html"><a href="r-package-rc.html#ex-set7"><i class="fa fa-check"></i><b>2.1.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="r-package-rc.html"><a href="r-package-rc.html#why-a-rc"><i class="fa fa-check"></i><b>2.2</b> Why a Research Compendium?</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r-package-rc.html"><a href="r-package-rc.html#ex-set8"><i class="fa fa-check"></i><b>2.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r-package-rc.html"><a href="r-package-rc.html#why-r-pack-for-rc"><i class="fa fa-check"></i><b>2.3</b> Why an R Package for a Research Compendium?</a></li>
<li class="chapter" data-level="2.4" data-path="r-package-rc.html"><a href="r-package-rc.html#rprw-to-rc"><i class="fa fa-check"></i><b>2.4</b> Turning RPRW Into A Research Compendium</a><ul>
<li class="chapter" data-level="2.4.1" data-path="r-package-rc.html"><a href="r-package-rc.html#ex-set9"><i class="fa fa-check"></i><b>2.4.1</b> Exercises</a></li>
<li class="chapter" data-level="2.4.2" data-path="r-package-rc.html"><a href="r-package-rc.html#citation"><i class="fa fa-check"></i><b>2.4.2</b> Adding a Citation</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r-package-rc.html"><a href="r-package-rc.html#rc-recap"><i class="fa fa-check"></i><b>2.5</b> Research Compendium Recap</a></li>
<li class="chapter" data-level="2.6" data-path="r-package-rc.html"><a href="r-package-rc.html#sharing-rc"><i class="fa fa-check"></i><b>2.6</b> Sharing Your Research Compendium</a></li>
<li class="chapter" data-level="2.7" data-path="r-package-rc.html"><a href="r-package-rc.html#hosting-your-research-compendium"><i class="fa fa-check"></i><b>2.7</b> Hosting Your Research Compendium</a><ul>
<li class="chapter" data-level="2.7.1" data-path="r-package-rc.html"><a href="r-package-rc.html#ex-set10"><i class="fa fa-check"></i><b>2.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="r-package-rc.html"><a href="r-package-rc.html#ex-rc"><i class="fa fa-check"></i><b>2.8</b> An Example R Package Reserach Compendium</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="extensions.html"><a href="extensions.html"><i class="fa fa-check"></i><b>3</b> Extensions</a><ul>
<li class="chapter" data-level="3.1" data-path="extensions.html"><a href="extensions.html#r-projects"><i class="fa fa-check"></i><b>3.1</b> R Projects</a><ul>
<li class="chapter" data-level="3.1.1" data-path="extensions.html"><a href="extensions.html#ex-set11"><i class="fa fa-check"></i><b>3.1.1</b> Exercises</a></li>
<li class="chapter" data-level="3.1.2" data-path="extensions.html"><a href="extensions.html#renv"><i class="fa fa-check"></i><b>3.1.2</b> renv</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="extensions.html"><a href="extensions.html#rmarkdown"><i class="fa fa-check"></i><b>3.2</b> R Markdown</a><ul>
<li class="chapter" data-level="3.2.1" data-path="extensions.html"><a href="extensions.html#ex-set12"><i class="fa fa-check"></i><b>3.2.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="extensions.html"><a href="extensions.html#rticles"><i class="fa fa-check"></i><b>3.3</b> rticles</a><ul>
<li class="chapter" data-level="3.3.1" data-path="extensions.html"><a href="extensions.html#ex-set13"><i class="fa fa-check"></i><b>3.3.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="extensions.html"><a href="extensions.html#git-github"><i class="fa fa-check"></i><b>3.4</b> Git and GitHub</a><ul>
<li class="chapter" data-level="3.4.1" data-path="extensions.html"><a href="extensions.html#cloning-a-github-repository-in-rstudio"><i class="fa fa-check"></i><b>3.4.1</b> Cloning a GitHub Repository in RStudio</a></li>
<li class="chapter" data-level="3.4.2" data-path="extensions.html"><a href="extensions.html#gitignore"><i class="fa fa-check"></i><b>3.4.2</b> <code>.gitignore</code></a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="extensions.html"><a href="extensions.html#ci"><i class="fa fa-check"></i><b>3.5</b> Continuous Integration</a></li>
<li class="chapter" data-level="3.6" data-path="extensions.html"><a href="extensions.html#style"><i class="fa fa-check"></i><b>3.6</b> Code Style</a></li>
<li class="chapter" data-level="3.7" data-path="extensions.html"><a href="extensions.html#add-tips"><i class="fa fa-check"></i><b>3.7</b> Additional Tips</a><ul>
<li class="chapter" data-level="3.7.1" data-path="extensions.html"><a href="extensions.html#ex-set14"><i class="fa fa-check"></i><b>3.7.1</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="extensions.html"><a href="extensions.html#thank-you"><i class="fa fa-check"></i><b>3.8</b> Thank you!</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="your-compendia.html"><a href="your-compendia.html"><i class="fa fa-check"></i><b>4</b> Turning An R Package into a Reproducible Research Compendia</a></li>
<li class="chapter" data-level="5" data-path="exercise-solutions.html"><a href="exercise-solutions.html"><i class="fa fa-check"></i><b>5</b> Exercise Solutions</a><ul>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#building-an-r-package"><i class="fa fa-check"></i>Building an R Package</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#making-an-r-package-a-research-compendium"><i class="fa fa-check"></i>Making an R Package a Research Compendium</a></li>
<li class="chapter" data-level="" data-path="exercise-solutions.html"><a href="exercise-solutions.html#extensions-1"><i class="fa fa-check"></i>Extensions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="chapter" data-level="6" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>6</b> Sharing your book</a><ul>
<li class="chapter" data-level="6.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>6.1</b> Publishing</a></li>
<li class="chapter" data-level="6.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>6.2</b> 404 pages</a></li>
<li class="chapter" data-level="6.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>6.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using R Packages for Reproducible Workflows</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r-package-rc" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Making an R Package a Research Compendium</h1>
<div id="what-is-a-rc" class="section level2">
<h2><span class="header-section-number">2.1</span> What is a Research Compendium?</h2>
<p><span class="citation">Marwick, Boettiger, and Mullen (<a href="#ref-marwick2018packaging" role="doc-biblioref">2018</a>)</span> state that the goal of a research compendium is to provide a standard and easily recognizable way to organize the digital materials of a project to enable others to inspect, reproduce, and extend the work. Three generic principles define a research compendium:</p>
<ol style="list-style-type: decimal">
<li><p>Files should be organized according to the prevailing conventions of a broader community. This helps members of the community recognize the structure of the project and make tools that utilize the structure.</p></li>
<li><p>There should be a clear separation of data, methods, and output. For example, raw data should be kept separate from the code that cleans the data so that others can access the raw data.</p></li>
<li><p>The computational environment for the methods should be clearly specified. At the most basic level, this means recording the names and version numbers of software. At the most detailed level, this means completely reproducing the computing environment.</p></li>
</ol>
<div id="ex-set7" class="section level3">
<h3><span class="header-section-number">2.1.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>What principles of a research compendium seem most beneficial to you?</li>
</ol>
</div>
</div>
<div id="why-a-rc" class="section level2">
<h2><span class="header-section-number">2.2</span> Why a Research Compendium?</h2>
<p><span class="citation">Marwick, Boettiger, and Mullen (<a href="#ref-marwick2018packaging" role="doc-biblioref">2018</a>)</span> (and references therein) give several benefits of a research compendium:</p>
<ul>
<li>A convenient way to publicly share data and code</li>
<li>Work with publicly available data sets may receive higher numbers of citations than work with private data sets (note that publicly available data sets also tend to be easier to clear through EPA platforms)</li>
<li>Data sharing is associated with higher publication productivity
<ul>
<li>Of 7,040 NSF and NIH awards studied, the median number of publications associated with each research grant was five when the data were private and 10 when the data were public</li>
</ul></li>
<li>Structured and simplified file management and workflows</li>
<li>More defense against errors</li>
<li>Easier to communicate with others (and future you)</li>
</ul>
<div id="ex-set8" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Can you identify any benefits to a research compendium that are not already on this list?</li>
</ol>
</div>
</div>
<div id="why-r-pack-for-rc" class="section level2">
<h2><span class="header-section-number">2.3</span> Why an R Package for a Research Compendium?</h2>
<p>As previously mentioned, a research compendium requires a specific structure. Earlier in this workshop, we got some experience with something in R that also requires a specific structure…………R packages! A research compendium can significantly benefit from adopting the structure of an R package. Organization is simpler (as you already have a structure), writing and documenting functions and data helps guard against errors in an analysis, and devtools and usethis have several development tools to help ensure your R package performs as intended.</p>
<p>We have previously discussed how to include data in an R package, but many of you may be wondering how we include additional pieces of a research compendium like analysis scripts, output, or a manuscript itself. If the structure of an R package is so rigid – how do these pieces fit? We discuss one such approach next.</p>
</div>
<div id="rprw-to-rc" class="section level2">
<h2><span class="header-section-number">2.4</span> Turning RPRW Into A Research Compendium</h2>
<p>If a folder named <code>inst</code> is placed at the root of an R package’s directory, all of the raw contents in <code>inst</code> will be installed upon installation of the R package. This is where we can put the pieces of our research compendium that are not explicitly related to the previous implementation of our R package. We can use this approach to turn RPRW into a research compendium.</p>
<p>Suppose we are using RPRW to supplement a manuscript about rivers. Let’s first add the <code>inst</code> folder – the root of your package’s directory should look similar to
<img src="images/newrpack_files9.PNG" width="100%" /></p>
<p>Let’s add three folders to <code>inst</code>:</p>
<ol style="list-style-type: decimal">
<li><code>analysis</code> for our analysis scripts – these scripts contain code that is not related to the functions in the package but is related to other parts of the research compendium (e.g. generating output for the manuscript)</li>
<li><code>output</code> for our analysis output</li>
<li><code>manuscript</code> for our manuscript
<img src="images/newrpack_files10.PNG" width="100%" /></li>
</ol>
<p>First we will make an R script to put in <code>analysis</code>. Recall that in Exercise 1.2.7.1.2 (<a href="r-package.html#ex-set3">internal link</a>), we generated <code>river_stats()</code>, whose body looks like</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="r-package-rc.html#cb101-1"></a>river_stats &lt;-<span class="st"> </span><span class="cf">function</span>(data, pattern, FUN, ...) {</span>
<span id="cb101-2"><a href="r-package-rc.html#cb101-2"></a>  desired_rivers &lt;-<span class="st"> </span><span class="kw">grep</span>(pattern, <span class="kw">names</span>(data))</span>
<span id="cb101-3"><a href="r-package-rc.html#cb101-3"></a>  new_data &lt;-<span class="st"> </span>data[, desired_rivers]</span>
<span id="cb101-4"><a href="r-package-rc.html#cb101-4"></a>  <span class="kw">apply</span>(new_data, <span class="dv">1</span>, FUN, ...)</span>
<span id="cb101-5"><a href="r-package-rc.html#cb101-5"></a>}</span></code></pre></div>
<p><code>river_stats()</code> works like <code>river_means()</code> and <code>river_medians()</code> but takes a general function instead of computing the mean or median specifically. Suppose our goal is to find the minimum length and discharge for rivers whose names contain “C”. Our script to put in <code>analysis</code> will look like</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="r-package-rc.html#cb102-1"></a><span class="co"># find some summary statistics on rivers with pattern &quot;C&quot;</span></span>
<span id="cb102-2"><a href="r-package-rc.html#cb102-2"></a></span>
<span id="cb102-3"><a href="r-package-rc.html#cb102-3"></a><span class="co">## load RPRW -- we need to do this because the script is separate from the </span></span>
<span id="cb102-4"><a href="r-package-rc.html#cb102-4"></a>  <span class="co">## functions installed in the RPRW package</span></span>
<span id="cb102-5"><a href="r-package-rc.html#cb102-5"></a><span class="kw">library</span>(RPRW) </span>
<span id="cb102-6"><a href="r-package-rc.html#cb102-6"></a></span>
<span id="cb102-7"><a href="r-package-rc.html#cb102-7"></a><span class="co">## find minimums</span></span>
<span id="cb102-8"><a href="r-package-rc.html#cb102-8"></a>river_min &lt;-<span class="st"> </span><span class="kw">river_stats</span>(river, <span class="st">&quot;C&quot;</span>, min)</span>
<span id="cb102-9"><a href="r-package-rc.html#cb102-9"></a></span>
<span id="cb102-10"><a href="r-package-rc.html#cb102-10"></a><span class="co">## make a data frame of the minimums</span></span>
<span id="cb102-11"><a href="r-package-rc.html#cb102-11"></a>min_df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb102-12"><a href="r-package-rc.html#cb102-12"></a>  <span class="dt">data =</span> <span class="st">&quot;river&quot;</span>,</span>
<span id="cb102-13"><a href="r-package-rc.html#cb102-13"></a>  <span class="dt">pattern =</span> <span class="st">&quot;C&quot;</span>,</span>
<span id="cb102-14"><a href="r-package-rc.html#cb102-14"></a>  <span class="dt">length_min =</span> river_min[[<span class="dv">1</span>]],</span>
<span id="cb102-15"><a href="r-package-rc.html#cb102-15"></a>  <span class="dt">discharge_min =</span> river_min[[<span class="dv">2</span>]]</span>
<span id="cb102-16"><a href="r-package-rc.html#cb102-16"></a>)</span>
<span id="cb102-17"><a href="r-package-rc.html#cb102-17"></a></span>
<span id="cb102-18"><a href="r-package-rc.html#cb102-18"></a><span class="co">## write out the minimums (without row names)</span></span>
<span id="cb102-19"><a href="r-package-rc.html#cb102-19"></a><span class="kw">write.csv</span>(min_df, <span class="st">&quot;inst/output/min_df&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p>This script loads RPRW and finds the minimum length and discharge for rivers whose names start with C. The script then saves the contents to a CSV file in the <code>output</code> folder. These contents are used when building the manuscript. The manuscript is in the <code>manuscript</code> folder and is a completely reproducible R Markdown document (using an rticles template, which we discuss later). Though we won’t discuss the details of this R Markdown document here unless we have time, the files can be viewed on your machine (after installing RPRW) at the location provided by</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="r-package-rc.html#cb103-1"></a><span class="kw">system.file</span>(<span class="st">&quot;manuscript&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;RPRW&quot;</span>)</span></code></pre></div>
<p>A compiled PDF of the manuscript is available here (<a href="https://github.com/michaeldumelle/RPRW/blob/main/inst/manuscript/manuscript.pdf">external link</a>).</p>
<div id="ex-set9" class="section level3">
<h3><span class="header-section-number">2.4.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>There is a folder name within <code>inst</code> that should be avoided – what is it?</li>
</ol>
</div>
<div id="citation" class="section level3">
<h3><span class="header-section-number">2.4.2</span> Adding a Citation</h3>
<p>Often times your research compendium may be centered around a particular publication. You may build an R package that deals with specific tasks and then write your manuscript using the research compendium structure. In this event, you may want your publication to be easily citable. You can add a citation to your R package research compendium by running</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="r-package-rc.html#cb104-1"></a><span class="kw">use_citation</span>()</span></code></pre></div>
<pre><code>√ Writing &#39;inst/CITATION&#39;
* Modify &#39;inst/CITATION&#39;</code></pre>
<p>The citation file is placed in the <code>inst</code> folder. It looks a little intimidating at first, but it automatically creates a text version and LaTeX version of your citation with relatively little ease. Here is raw code I used to create the citation in the RPRW package</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="r-package-rc.html#cb106-1"></a><span class="kw">citHeader</span>(<span class="st">&quot;To cite RPRW in publications use:&quot;</span>)</span>
<span id="cb106-2"><a href="r-package-rc.html#cb106-2"></a></span>
<span id="cb106-3"><a href="r-package-rc.html#cb106-3"></a><span class="kw">citEntry</span>(</span>
<span id="cb106-4"><a href="r-package-rc.html#cb106-4"></a>  <span class="dt">entry    =</span> <span class="st">&quot;Manual&quot;</span>,</span>
<span id="cb106-5"><a href="r-package-rc.html#cb106-5"></a>  <span class="dt">title    =</span> <span class="st">&quot;Using R Packages for Reproducible Workflows&quot;</span>,</span>
<span id="cb106-6"><a href="r-package-rc.html#cb106-6"></a>  <span class="dt">author   =</span> <span class="kw">personList</span>(<span class="kw">as.person</span>(<span class="st">&quot;Michael Dumelle&quot;</span>)),</span>
<span id="cb106-7"><a href="r-package-rc.html#cb106-7"></a>  <span class="dt">journal  =</span> <span class="st">&quot;EPA 2021 R Workshop&quot;</span>,</span>
<span id="cb106-8"><a href="r-package-rc.html#cb106-8"></a>  <span class="dt">url      =</span> <span class="st">&quot;https://github.com/michaeldumelle/R-Packages-Reproducible-Workflows-Book&quot;</span>,</span>
<span id="cb106-9"><a href="r-package-rc.html#cb106-9"></a>  <span class="dt">textVersion =</span></span>
<span id="cb106-10"><a href="r-package-rc.html#cb106-10"></a>  <span class="kw">paste</span>(</span>
<span id="cb106-11"><a href="r-package-rc.html#cb106-11"></a>    <span class="st">&quot;Michael Dumelle.&quot;</span>,</span>
<span id="cb106-12"><a href="r-package-rc.html#cb106-12"></a>    <span class="st">&quot;(2021).&quot;</span>,</span>
<span id="cb106-13"><a href="r-package-rc.html#cb106-13"></a>    <span class="st">&quot;Using R Packages for Reproducible Workflows.&quot;</span>,</span>
<span id="cb106-14"><a href="r-package-rc.html#cb106-14"></a>    <span class="st">&quot;EPA 2021 R Workshop.&quot;</span>,</span>
<span id="cb106-15"><a href="r-package-rc.html#cb106-15"></a>    <span class="st">&quot;URL https://github.com/michaeldumelle/R-Packages-Reproducible-Workflows-Book.&quot;</span></span>
<span id="cb106-16"><a href="r-package-rc.html#cb106-16"></a>  )</span>
<span id="cb106-17"><a href="r-package-rc.html#cb106-17"></a>)</span></code></pre></div>
<p>To view the citation, run</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="r-package-rc.html#cb107-1"></a><span class="kw">citation</span>(<span class="dt">package =</span> <span class="st">&quot;RPRW&quot;</span>)</span></code></pre></div>
<pre><code>#&gt; 
#&gt; To cite RPRW in publications use:
#&gt; 
#&gt;   Michael Dumelle. (2021). Using R Packages for Reproducible Workflows.
#&gt;   EPA 2021 R Workshop. URL
#&gt;   https://github.com/michaeldumelle/R-Packages-Reproducible-Workflows-Book.
#&gt; 
#&gt; A BibTeX entry for LaTeX users is
#&gt; 
#&gt;   @Manual{,
#&gt;     title = {Using R Packages for Reproducible Workflows},
#&gt;     author = {Michael Dumelle},
#&gt;     journal = {EPA 2021 R Workshop},
#&gt;     url = {https://github.com/michaeldumelle/R-Packages-Reproducible-Workflows-Book},
#&gt;   }</code></pre>
<p>If left unedited, the package citation defaults to something that looks like</p>
<pre><code> 
 To cite package &#39;RPRW&#39; in publications use:
 
   Michael Dumelle (2021). RPRW: R Packages for Reproducible Workflows.
   R package version 0.0.0.9000.
 
 A BibTeX entry for LaTeX users is
 
   @Manual{,
     title = {RPRW: R Packages for Reproducible Workflows},
     author = {Michael Dumelle},
     year = {2021},
     note = {R package version 0.0.0.9000},
   }</code></pre>
</div>
</div>
<div id="rc-recap" class="section level2">
<h2><span class="header-section-number">2.5</span> Research Compendium Recap</h2>
<p>The research compendium now visibly contains:</p>
<ul>
<li><code>data</code>: a folder containing data</li>
<li><code>DESCRIPTION</code>: a file containing metadata about our package</li>
<li><code>inst</code>: a folder containing auxiliary files to be downloaded alongside the package’s installation
<ul>
<li><code>analysis</code>: a folder containing R scripts that are separate from the R package but used as part of the research compendium</li>
<li><code>CITATION</code>: a file containing citation information</li>
<li><code>manuscript</code>: a file containing the manuscript and auxiliary files</li>
<li><code>output</code>: a file containing the CSV output</li>
</ul></li>
<li><code>LICENSE.md</code>: a file containing metadata about our license (GPL-3)</li>
<li><code>man</code>: a folder containing R function documentation from the package</li>
<li><code>NAMESPACE</code>: a file containing exports and imports</li>
<li><code>R</code>: a folder containing R functions from the package</li>
<li><code>RPRW.Rproj</code>: a file containing R Project metadata</li>
<li><code>tests</code>: a folder containing R function testing</li>
<li><code>vignettes</code>: a folder containing the package vignette</li>
</ul>
<p>You can also add a <code>README.md</code> file to give a broad overview of your package (<code>README.md</code> is useful whether or not you use Git and GitHub). The <code>README.md</code> file is a Markdown (<a href="https://www.markdownguide.org/">external link</a>) file (notice the .md extension and notice the connection between R Markdown (<code>.Rmd</code>) and Markdown (<code>.md</code>)) in the RPRW package that looks like</p>
<pre><code># RPRW
Companion R package for &quot;Using R Packages for Reproducible Workflows&quot; at the 2021 EPA R Workshop
</code></pre>
</div>
<div id="sharing-rc" class="section level2">
<h2><span class="header-section-number">2.6</span> Sharing Your Research Compendium</h2>
<p>So now you have a research compendium that combines your R functions with your data, code, and manuscript to create a reproducible product that is easy to share with your colleagues. But how do we share it? Running</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="r-package-rc.html#cb111-1"></a>devtools<span class="op">::</span><span class="kw">build</span>()</span></code></pre></div>
<p>will build an R package for you. By default, the package will be located in the same folder as the folder containing your R package with name “package-name_version-number.tar.gz”. Note that this is one level above the location of your R package’s directory. For example, if folder “A” holds “RPRW”, which is the folder containing all of the files associated with my R package, then using <code>devtools::build()</code> will install “RPRW_0.0.0.9000.tar.gz” in folder “A”. If there are any files in your package folder that you do not present in the installed version of the package, place the file paths in the <code>.Rbuildignore</code> file. Fore more on <code>.Rbuildignore</code>, visit here (<a href="https://r-pkgs.org/package-structure-state.html#rbuildignore">external link</a>).</p>
<p>After building the package, you can send it to a colleague, they can save it on their machine, and then they can install it by running</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="r-package-rc.html#cb112-1"></a><span class="kw">install.packages</span>(path_to_package, <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type =</span> <span class="st">&quot;source&quot;</span>)</span></code></pre></div>
<p>If your colleague doesn’t remember where they saved the file, they can interactively search for it by running</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="r-package-rc.html#cb113-1"></a><span class="kw">install.packages</span>(<span class="kw">file.choose</span>(), <span class="dt">repos =</span> <span class="ot">NULL</span>, <span class="dt">type =</span> <span class="st">&quot;source&quot;</span>)</span></code></pre></div>
<p>Because R packages leverage R projects your colleague can immediately run any of your code on their machine (a reminder that we discuss R projects soon)!</p>
</div>
<div id="hosting-your-research-compendium" class="section level2">
<h2><span class="header-section-number">2.7</span> Hosting Your Research Compendium</h2>
<p>You can host your research compendium in an open-access repository so that a broader audience may access it. One approach is to host it on GitHub, which we discuss more later. This approach has the advantage of being easy to install by running</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="r-package-rc.html#cb114-1"></a>devtools<span class="op">::</span><span class="kw">install_github</span>(<span class="st">&quot;GitHub_user_name/repository_name&quot;</span>, <span class="st">&quot;repository_branch&quot;</span>)</span></code></pre></div>
<p>You can also put your research compendium on Zenodo (<a href="https://zenodo.org/">external link</a>). Zenodo is an open-access repository designed to permanently archive research compendia. GitHub and Zenodo compliment each other nicely: GitHub acts as the “easy to access” version of the research compendium while Zenodo is the more permanent version. For an example of a research compendium that combines these approaches, visit the GitHub repository here (<a href="https://github.com/usepa/ri_wq_trends">external link</a>) and Zenodo archive here (<a href="https://zenodo.org/record/4306765#.YUygPbhKhPY">external link</a>).</p>
<div id="ex-set10" class="section level3">
<h3><span class="header-section-number">2.7.1</span> Exercises</h3>
<ol style="list-style-type: decimal">
<li>Run <code>?devtools::build</code> to look at some additional arguments – which seem useful to you?</li>
</ol>
</div>
</div>
<div id="ex-rc" class="section level2">
<h2><span class="header-section-number">2.8</span> An Example R Package Reserach Compendium</h2>
<p>A recent publication of mine used this R package research compendium structure – you can view the GitHub repository here (<a href="https://github.com/michaeldumelle/DumelleEtAl2021STLMM">external link</a>).</p>

</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-marwick2018packaging">
<p>Marwick, Ben, Carl Boettiger, and Lincoln Mullen. 2018. “Packaging Data Analytical Work Reproducibly Using R (and Friends).” <em>The American Statistician</em> 72 (1): 80–88.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="r-package.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="extensions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/02-a-research-compendium.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "lunr",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

</body>

</html>
